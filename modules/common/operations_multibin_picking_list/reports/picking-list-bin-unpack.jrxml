<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.17.0.final using JasperReports Library version 6.17.0-6d93193241dd8cc42629e188b94f9e0bc5722efd  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
              name="Internal Picking List (unpack)" pageWidth="595" pageHeight="842" columnWidth="595" leftMargin="0"
              rightMargin="0" topMargin="0" bottomMargin="0" uuid="c46c463d-f039-4528-8ce9-7eeea73281a0">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <style name="Base" isDefault="true" fontName="Droid Sans" fontSize="10" isBold="false" isItalic="false"
           isUnderline="false" isStrikeThrough="false"/>
    <parameter name="viaduct" class="nz.optimysme.viaduct.Viaduct"/>
    <parameter name="viaduct-report-ids" class="java.util.List">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="viaduct-directory" class="java.lang.String"/>
    <parameter name="source-directory" class="java.lang.String"/>
    <queryString>
        <![CDATA[select
  id,
  case
    when sale_id is not null then 'sale'
    when (select count (*) from stock_move where picking_id = stock_picking.id) > 0 then 'purchase'
    else 'internal'
  end as direction
from
  stock_picking
where $X{IN, id, viaduct-report-ids}
order by id]]>
    </queryString>
    <field name="id" class="java.lang.Integer"/>
    <field name="direction" class="java.lang.String"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <detail>
        <band height="15" splitType="Stretch">
            <subreport runToBottom="true">
                <reportElement x="0" y="0" width="595" height="15" uuid="c27583d0-bc3b-448a-a4f0-e2a440a15427"/>
                <subreportParameter name="source-directory">
                    <subreportParameterExpression><![CDATA[$P{source-directory}]]></subreportParameterExpression>
                </subreportParameter>
                <subreportParameter name="viaduct">
                    <subreportParameterExpression><![CDATA[$P{viaduct}]]></subreportParameterExpression>
                </subreportParameter>
                <subreportParameter name="viaduct-directory">
                    <subreportParameterExpression><![CDATA[$P{viaduct-directory}]]></subreportParameterExpression>
                </subreportParameter>
                <subreportParameter name="stock-picking-id">
                    <subreportParameterExpression><![CDATA[$F{id}]]></subreportParameterExpression>
                </subreportParameter>
                <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                <subreportExpression>
                    <![CDATA[String.format ("%s/%s-picking-list.jasper", $P{viaduct-directory}, $F{direction})]]></subreportExpression>
            </subreport>
        </band>
    </detail>
</jasperReport>
