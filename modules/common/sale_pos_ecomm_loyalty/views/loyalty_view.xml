<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
	 <!-- all Loyalty Configuration -->
		 <record id="view_website_loyalty_setting_tree_view" model="ir.ui.view">
			<field name="name">res.config.settings.view.custom</field>
			<field name="model">res.config.settings</field>
			<field name="inherit_id" ref="website.res_config_settings_view_form"/>
			<field name="arch" type="xml">
				<xpath expr="//block[@id='website_info_settings']" position="after">
					<h2>Allow loyalty points accruement</h2>

					<div class="row mt16 o_settings_container" id="allow_loyalty_setting">
						<div class="col-12 col-lg-6 o_setting_box">
							<div class="o_setting_left_pane">
								<field name="allow_to_loyalty"/>
							</div>
							<div class="o_setting_right_pane">
								<label for="allow_to_loyalty"/>
								<div class="text-muted">
									Allow loyalty points to be accrued from purchases made through the website store.
								</div>
							</div>
						</div>
						<div class="col-12 col-lg-6 o_setting_box" invisible="not allow_to_loyalty">
							<div class="o_setting_left_pane">
								<field name="allow_prezzy_redemption"/>
							</div>
							<div class="o_setting_right_pane">
								<label for="allow_prezzy_redemption"/>
								<div class="text-muted">
									Allow Prezzy card redemption from Contact view
								</div>
							</div>
						</div>
						<div class="col-12 col-lg-6 o_setting_box" invisible="not allow_to_loyalty">
							<div class="o_setting_left_pane">
								<field name="disallow_overdue"/>
							</div>
							<div class="o_setting_right_pane">
								<label for="disallow_overdue"/>
								<div class="text-muted">
									Disallow points for being accrued for customers with overdue payments
								</div>
							</div>
						</div>
					</div>

				</xpath>
			</field>
		</record>


		<record id="view_web_loyalty_setting_tree_view" model="ir.ui.view">
			<field name="name">all.loyalty.config.tree.view</field>
			<field name="model">all.loyalty.setting</field>
			<field name="arch" type="xml">
				<list string=" Loyalty Configuration">
					<field name="name"/>
					<field name="product_id"/>
					<field name="issue_date"/>
					<field name="expiry_date"/>
					<field name="active"/>
				</list>
			</field>
		</record>
		<record id="web_loyalty_setting_form_view" model="ir.ui.view">
			<field name="name">all.loyalty.config.form.view</field>
			<field name="model">all.loyalty.setting</field>
			<field name="arch" type="xml">
				<form string=" Loyalty Configuration">
					<sheet>
						<group>
							<group>
								<field name="name" required="1"/>
								<field name="product_id"/>
								<field name="active"/>
							</group>
							<group>
								<field name="issue_date"/>
								<field name="expiry_date"/>
								<field name="multi_company_ids" widget="many2many_tags"/>
							</group>
						</group>
						 <notebook>
							<page string="Loyalty Calculation">
								<group>
									<field name="loyalty_basis_on"/>
									<field name="loyality_amount" invisible="loyalty_basis_on != 'amount'" required="loyalty_basis_on == 'amount'"/>
									<br/>
									<div invisible="loyalty_basis_on != 'loyalty_category'">
										<button name="%(product.product_category_action_form)d" icon="fa-arrow-right" type="action" string="Product Categories (For Sale)" class="btn-link"/>
										<br/>
										<button name="%(point_of_sale.product_pos_category_action)d" icon="fa-arrow-right" type="action" string="POS Product Categories (For POS)" class="btn-link"/>
										<br/>
										<button name="%(website_sale.product_public_category_action)d" icon="fa-arrow-right" type="action" string="Website Categories (For Website)" class="btn-link"/>
									</div>
								</group>
									<div invisible="loyalty_basis_on != 'amount'">
									<b style="color:blue">
									<span>1 Point(s) </span>
									</b>
									<b style="margin: 0px 7px;">
										<span> For a Purchase of every</span>
									</b>
									<b style="color:blue">
										<field name="amount_footer" nolabel="1" class="oe_inline"/>
									</b>
									</div>
							</page>
							<page string="Redemption Rule">
								<field name="redeem_ids">
									<list>
										<field name="name"/>
										<field name="min_amt"/>
										<field name="max_amt"/>
										<field name="reward_amt"/>
									</list>
									<form string="Website Redeem Rule Form">
										<sheet>
											<group>
												<field name="name"/>
											</group>
											<seperator col="4" string="Redemption Computation"/>
											<b>
												<span>Rule :  Points Between</span>
											</b>
											<b style="color:blue">
												<field name="min_amt" nolabel="1" class="oe_inline"/>
											</b>
											<b>
												<span>and</span>
											</b>
											<b style="color:blue">
												<field name="max_amt" nolabel="1" class="oe_inline"/>
											</b>
											<b>
												<span>: 1 reward point =</span>
											</b>
											<b style="color:green">
												<field name="reward_amt" nolabel="1" class="oe_inline" />
											</b>
										</sheet>
									</form>
								</field>
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>
		<record model="ir.actions.act_window" id="action_web_loyalty_setting">
			<field name="name">Loyalty Configuration</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">all.loyalty.setting</field>
			<field name="view_mode">list,form</field>
		</record>
		<!-- website Loyalty History -->
		<record id="view_web_loyalty_history_tree_view" model="ir.ui.view">
			<field name="name">all.loyalty.history.tree.view</field>
			<field name="model">all.loyalty.history</field>
			<field name="arch" type="xml">
			   <list string="Website Loyalty History" create="0" edit="0">
					<field name="order_id"/>
					<field name='pos_order_id'/>
					<field name="partner_id"/>
					<field name="loyalty_config_id"/>
					<field name="company_id"/>
					<field name="transaction_type"/>
					<field name="date"/>
					<field name="state"/>
					<field name="points"/>
					<field name="check_state" invisible="1"/>
				</list>
			</field>
		</record>
		<record id="web_loyalty_history_form_view" model="ir.ui.view">
			<field name="name">all.loyalty.history.form.view</field>
			<field name="model">all.loyalty.history</field>
			<field name="arch" type="xml">
				<form string="Loyalty History" create="0" edit="0">
					<header>
						<field name="state" widget="statusbar" statusbar_visible="draft,done,cancel"/>
					</header>
					<sheet>
						<group>
							<group>
								<field name='generated_from'/>
								<field name="order_id" invisible="generated_from == 'pos'" />
								<field name='pos_order_id' invisible="generated_from != 'pos'"/>
								<field name="partner_id"/>
								<field name="transaction_type"/>
								<field name="loyalty_config_id"/>
							</group>
						<group>
							<field name="date"/>
							<field name="points"/>
							<field name="check_state" invisible="1"/>
						</group>
						</group>
					</sheet>
				</form>
			</field>
		</record>
		<record model="ir.actions.act_window" id="action_web_loyalty_history">
			<field name="name">Loyalty History</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">all.loyalty.history</field>
			<field name="view_mode">list,form</field>
		</record>
		<menuitem name="Loyalty Management" id="menu_web_loyalty_id"  sequence="10"/>
		<menuitem parent="sale_pos_ecomm_loyalty.menu_web_loyalty_id" action="action_web_loyalty_setting" id="menu_web_loyalty_setting"
				sequence="5"/>
		<menuitem parent="sale_pos_ecomm_loyalty.menu_web_loyalty_id" action="action_web_loyalty_history" id="menu_web_loyalty_history"
				sequence="6"/>
		<!-- res.partner Configuration -->
		<record id="view_res_partner_loyalty_form" model="ir.ui.view">
			<field name="name">res.partner.website.loyalty.form.inherit</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="base.view_partner_form"/>
			<field name="arch" type="xml">
				<field name="vat" position="after">
					<field string="Loyalty Points" name="loyalty_pts" invisible="1"/>
				</field>
				<div name="button_box" position="inside">
					<button type="object" name="action_view_loyalty_pts" class="oe_stat_button" icon="fa-usd"  invisible="loyalty_pts == 0">
						<div class="o_form_field o_stat_info">
							<span class="o_stat_value">
								<field name="loyalty_pts"/>
							</span>
							<span class="o_stat_text">Loyalty Points</span>
						</div>
					</button>
				</div>
			</field>
		</record>
		<!-- website.category Configuration -->
		<record model="ir.ui.view" id="web_category_loyalty_inherit">
			<field name="name">website.product.public.category.loyalty.view.form</field>
			<field name="model">product.public.category</field>
			<field name="inherit_id" ref="website_sale.product_public_category_form_view"/>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='sequence']" position="after">
					<field name="Minimum_amount"/>
				</xpath>
				<xpath expr="//div" position="after">
					<group>
						<div>
							<b style="color:blue"> <span>1 Point(s)</span></b>
							<b style="margin: 0px 7px;"><span>For a Purchase of every</span></b>
							<b style="color:blue">
								<field name="amount_footer" nolabel="1" class="oe_inline"/>
							</b>
						</div>
					</group>
				</xpath>
			</field>
		</record>
		<record model="ir.ui.view" id="pos_category_loyalty_inherit">
			<field name="name">pos.category.loyalty.view.form</field>
			<field name="model">pos.category</field>
			<field name="inherit_id" ref="point_of_sale.product_pos_category_form_view"/>
			<field name="arch" type="xml">
				<xpath expr="//group" position="after">
					<group>
						<div>
							<b style="color:blue"> <span>1 Point(s)</span></b>
							<b style="margin: 0px 7px;"><span>For a Purchase of every</span></b>
							<b style="color:blue">
								<field name="amount_footer" nolabel="1" class="oe_inline"/>
							</b>
						</div>
					</group>
				</xpath>
				<xpath expr="//field[@name='color']" position="after">
					<field name="Minimum_amount"/>
				</xpath>
			</field>
		</record>
		<record model="ir.ui.view" id="sale_category_loyalty_inherit">
			<field name="name">sale.category.loyalty.view.form</field>
			<field name="model">product.category</field>
			<field name="inherit_id" ref="product.product_category_form_view"/>
			<field name="arch" type="xml">
				<group name="first" position="after">
					<group string="Loyalty Configuration">
						<group col="2">
							<field name="Minimum_amount"/>
							<div>
								<b style="color: blue"> <span>1 Point(s)</span></b>
								<b style="margin: 0px 7px;"><span>For a Purchase of every </span></b>
								<b style="color: blue">
									<field name="amount_footer" nolabel="1" class="oe_inline"/>
								</b>
							</div>
						</group>
					</group>
				</group>
			</field>
		</record>
		<record id="view_res_partner_loyalty_form_inherit" model="ir.ui.view">
			<field name="name">res.partner.loyalty.form.inherit</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="sale_pos_ecomm_loyalty.view_res_partner_loyalty_form"/>
			<field name="arch" type="xml">
				<field name="vat" position="after">
					<field string="Loyalty Points" name="loyalty_pts" invisible="1"/>
				</field>
				<div name="button_box" position="inside">
					<field name="allow_prezzy_redemption" invisible="1"/>
					<button type="action" name="%(sale_pos_ecomm_loyalty.action_issue_prezzy_card)d" class="oe_stat_button" icon="fa-usd"
							invisible="loyalty_pts == 0 or not allow_prezzy_redemption">
						<div class="o_form_field o_stat_info">
							<span class="o_stat_text">Issue Prezzy Card</span>
						</div>
					</button>
				</div>
			</field>
		</record>
		<record id="view_partner_form_inherit" model="ir.ui.view">
			<field name="name">res.partner.prezzy.history</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="base.view_partner_form" />
			<field name="arch" type="xml">
                <xpath expr="//notebook[last()]" position="inside">
					<page string="Prezzy Card History" name="prezzy_history" invisible="not prezzy_card_history" >
						<field name="prezzy_card_history">
							<list create="false" delete="false" edit="false">
								<field name="deduction_date" readonly="1"/>
								<field name="partner_id" readonly="1"/>
								<field name="deduction_amount" readonly="1"/>
								<field name="card_value" readonly="1"/>
								<field name="notes" readonly="1"/>
							</list>
						</field>
                    </page>
                </xpath>
            </field>
		</record>
	</data>
</odoo>
